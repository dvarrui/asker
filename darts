#!/usr/bin/ruby
# encoding: utf-8

require 'rainbow'
require 'pry'
require_relative 'lib/tool'
require_relative 'lib/application'
require_relative 'lib/builder/project_builder'
require_relative 'lib/sinatra/sinatra_front_end'

def show_help
  puts "Usage: #{$0}\n\n"
  puts "  "+Rainbow("input/path/to/[HAMLFILE|XMLFILE]").green+" => Build output files, from HAML/XML input file."
  puts "                                      Example: "+Rainbow($0+" input/foo/foo.haml").yellow
  puts "                                      Example: "+Rainbow($0+" input/foo/foo.xml").yellow
  puts "  "+Rainbow("--web, -w, web, w  ").green+"              => Init Web Editor."
  puts "  "+Rainbow("--help, -h, help, h").green+"              => Show this help."
  puts "  "+Rainbow("--version, -v, version, v").green+"        => Show the program version."
  puts "\n\n"
  puts "  DEPRECATED:\n"
  puts "    --create PROJECTNAME      => Create new FOO project."
  puts "                                 Example: #{$0} create foo"
  puts "    project/path/to/YAMLFILE  => Build output files from YAML config file."
  puts "                                 Example: #{$0} projects/foo/foo.yaml"
  puts ""
end

def show_version
  puts Rainbow(Application::name).bright.blue+" (version "+Rainbow(Application::version).green+")"
end

if ARGV.count==0 then
  puts "Usage: "+Rainbow($0+" --help").yellow
elsif ['h', '-h', 'help', '--help'].include?(ARGV.first) then
  show_help
elsif ['v', '-v', 'version', '--version'].include?(ARGV[0]) then
  show_version
elsif ['c', '-c', 'create', '--create'].include?(ARGV[0]) then
  ProjectBuilder::create_project( ARGV[1] )
elsif ['w', '-w', 'web', '--web' ].include?(ARGV[0]) then
  SinatraFrontEnd.run!
else
  Tool.new.start(ARGV.first)
end
